```squirrel title:
function getImmuneTypeDamgeRate_ATMage(obj, damageRate, attacker) {

	if (obj.getVar("firepillar").size_vector() > 0) {
		if (obj.getVar("firepillar").get_vector(VECTOR_FLAG_2)) {
			if (attacker) {
				local skillLevel = obj.sq_GetSkillLevel(SKILL_FIREPILLAR);
				local N = obj.sq_GetLevelData(SKILL_FIREPILLAR, 0, skillLevel);
				damageRate = damageRate - N;
			}
		}
	}

	if (CNSquirrelAppendage.sq_IsAppendAppendage(obj, "Character/ATMage/DieHard/ap_ATMage_DieHardSlowHeal.nut")) {

		local increaseDamageRate = sq_GetIntData(obj, SKILL_DIEHARD, SKL_STATIC_INT_IDX_0);

		damageRate = damageRate + increaseDamageRate;
	}
	return damageRate;
}
```